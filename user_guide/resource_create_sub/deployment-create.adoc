= 디플로이먼트 생성
:toc:
:toc-title:

본 장에서는 디플로이먼트 리소스의 생성 방법에 대해서 설명한다.

== YAML 에디터

새로운 디플로이먼트를 YAML 에디터를 사용해서 생성할 수 있다.

. <<../console_menu_sub/work-load#img-deployment-main,디플로이먼트 메인 화면>>에서 *[디플로이먼트 생성]* 버튼을 클릭한다.
. 드롭다운 메뉴가 열리면 **[Yaml 에디터]**를 클릭한다.
. YAML 에디터 화면이 열리면 생성할 디플로이먼트의 구성 정보를 작성한다.
+
.기본 작성 예
[source,yaml]
----
apiVersion: apps/v1
kind: Deployment
metadata:
  name: example <1>
  namespace: default <2>
spec:
  selector: 
    matchLabels: <3>
      app: hello-hypercloud
    replicas: 3 <4>
    template: <5>
      metadata: 
        labels: <6>
          app: hello-hypercloud
      spec: 
      containers: <7>
        - name: hello-hypercloud <8>
          image: hypercloud/hello-hypercloud <9>
          ports: <10>
            - containerPort: 8080 <11>
----
+
<1> 디플로이먼트의 이름
<2> 디플로이먼트가 생성될 네임스페이스의 이름
<3> 디플로이먼트가 관리할 파드의 레이블 정보
<4> 파드 복제본의 개수
<5> 생성할 파드에 대한 상세 명세
<6> 파드를 분류할 때 사용할 레이블 정보 (키-값 형식)
<7> 파드를 구성할 컨테이너의 상세 내역
<8> 컨테이너의 이름
<9> 컨테이너의 이미지
<10> 컨테이너에서 노출할 포트 목록
<11> 파드의 IP 주소에서 노출할 포트 번호
. 작성이 완료되면 *[생성]* 버튼을 클릭해서 작성 내용을 저장한다.

== 폼 에디터

새로운 디플로이먼트를 폼 에디터를 사용해서 생성할 수 있다.

. <<../console_menu_sub/work-load#img-deployment-main,디플로이먼트 메인 화면>>에서 *[디플로이먼트 생성]* 버튼을 클릭한다.
. 드롭다운 메뉴가 열리면 **[폼 에디터]**를 클릭한다.
. *디플로이먼트 생성* 화면이 열리면 생성할 디플로이먼트의 구성 정보를 설정한다. +
각 설정 항목에 대한 설명은 다음과 같다.
+
[width="100%",options="header", cols="1,3a"]
|====================
|항목|설명  
|이름|디플로이먼트의 이름을 입력한다.
|컨테이너 이미지|애플리케이션을 구동하기 위한 컨테이너 이미지의 이름을 입력한다.
|이미지 풀 폴리시|컨테이너에 대해 사용할 이미지를 가져오는 방식을 선택한다.

* If Not Present : 이미지가 로컬에 없는 경우에만 이미지를 가져온다.
* 항상 : 컨테이너가 시작할 때마다 이미지를 가져온다.
* 절대 안 함 : 이미지를 가져오지 않는다.
|레플리카|파드 복제본의 생성 개수를 입력한다.
|레이블|디플로이먼트에 추가할 레이블 정보를 입력한다.
|커맨드 실행|파드 안에서 컨테이너가 동작할 때 실행할 커맨드(Command 필드)를 정의한다. +
이때 **[+ 추가]**를 클릭하면 입력 항목이 하나씩 추가되고, *[-]* 버튼을 클릭하면 입력 항목을 삭제할 수 있다.
|커맨드 인수 실행|커맨드의 인자(Args 필드)를 정의한다. +
이때 **[+ 추가]**를 클릭하면 입력 항목이 하나씩 추가되고, *[-]* 버튼을 클릭하면 입력 항목을 삭제할 수 있다.
|환경 변수|디플로이먼트의 환경 변수를 설정한다. +
이때 **[+ 추가]**를 클릭하면 입력 항목이 하나씩 추가되고, *[-]* 버튼을 클릭하면 입력 항목을 삭제할 수 있다.

* 키 : 환경 변수의 이름을 입력
* 값 : 환경 변수의 기본값을 입력
|포트|컨테이너에서 노출할 포트 정보를 설정한다. +
이때 **[+ 추가]**를 클릭하면 입력 항목이 하나씩 추가되고, *[-]* 버튼을 클릭하면 입력 항목을 삭제할 수 있다.

* 포트 이름 : 포트 정보의 이름을 입력
* 포트 : 포트 번호를 입력
* 프로토콜 : 네트워크 프로토콜을 선택 (TCP, UDP, SCDP)
|볼륨|파드에 추가할 볼륨의 정보를 설정한다. +
이때 **[+ 추가]**를 클릭하면 입력 항목이 하나씩 추가되고, *[-]* 버튼을 클릭하면 입력 항목을 삭제할 수 있다.

* 볼륨 이름 : 볼륨의 이름을 입력
* 마운트 경로 : 마운트할 볼륨의 경로 입력
* 영구 볼륨 클레임 : 적용할 영구 볼륨 클레임의 이름을 선택
* Read Only : 읽기/쓰기 모드 선택
|리소스(요청)|파드가 스케줄되기 위해 필요한 최소 자원의 양을 설정한다. +
이때 **[+ 추가]**를 클릭하면 입력 항목이 하나씩 추가되고, *[-]* 버튼을 클릭하면 입력 항목을 삭제할 수 있다.

* 리소스 : 자원의 종류 입력
* 수량 : 필요한 최소의 양 입력
|리소스(제한)|파드의 컨테이너 생성 후 실행 시 사용 가능한 최대 자원의 양을 설정한다. +
이때 **[+ 추가]**를 클릭하면 입력 항목이 하나씩 추가되고, *[-]* 버튼을 클릭하면 입력 항목을 삭제할 수 있다.

* 리소스 : 자원의 종류 입력
* 수량 : 필요한 최대의 양 입력
|재시작 정책|종료된 컨테이너의 재시작 방식을 선택한다.

* 항상 : 항상 재시작한다.
* 실패시 : 정상적으로 종료되지 않은 경우에만 재시작한다.
* 절대 안 함 : 재시작 하지 않는다.
|====================
. 설정이 완료되면 *[생성]* 버튼을 클릭해서 설정 내용을 저장한다.

NOTE: 커맨드(Command 필드) 및 커맨드 인자(Args 필드)에 적용되는 규칙은 다음과 같다. +
- 커맨드(Command 필드)와 커맨드 인자(Args 필드)를 모두 정의한 경우 이미지에 정의된 Entrypoint 필드 값은 커맨드(Command 필드) 값으로, Cmd 필드 값은 커맨드 인자(Args 필드) 값으로 덮여 쓰인다. +
- 커맨드(Command 필드)만 정의한 경우 이미지에 정의된 Entrypoint 필드 값은 커맨드(Command 필드) 값으로, Cmd 필드 값은 정의되지 않는 상태로 덮여 쓰인다. + 
- 커맨드 인자(Args 필드)만 정의한 경우 이미지의 Cmd 필드 값만 덮여 쓰인다.